(self.webpackChunklektor_front=self.webpackChunklektor_front||[]).push([[9840],{9840:(e,t,a)=>{"use strict";a.r(t),a.d(t,{CameraPreviewWeb:()=>s,CameraPreview:()=>i});var r=a(546);class s extends r.Uw{constructor(){super({name:"CameraPreview",platforms:["web"]})}async start(e){return new Promise(async(t,a)=>{await navigator.mediaDevices.getUserMedia({audio:!e.disableAudio,video:!0}).then(e=>{e.getTracks().forEach(e=>e.stop())}).catch(e=>{a(e)});const r=document.getElementById("video"),s=document.getElementById(e.parent);if(r)a({message:"camera already started"});else{const r=document.createElement("video");r.id="video",r.setAttribute("class",e.className||""),"rear"!==e.position&&r.setAttribute("style","-webkit-transform: scaleX(-1); transform: scaleX(-1);");const i=navigator.userAgent.toLowerCase();if(i.includes("safari")&&!i.includes("chrome")&&(r.setAttribute("autoplay","true"),r.setAttribute("muted","true"),r.setAttribute("playsinline","true")),s.appendChild(r),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){const s={video:{width:{ideal:e.width},height:{ideal:e.height}}};"rear"===e.position?(s.video.facingMode="environment",this.isBackCamera=!0):this.isBackCamera=!1,navigator.mediaDevices.getUserMedia(s).then(function(e){r.srcObject=e,r.play(),t({})},e=>{a(e)})}}})}async stop(){const e=document.getElementById("video");if(e){e.pause();const a=e.srcObject.getTracks();for(var t=0;t<a.length;t++)a[t].stop();e.remove()}}async capture(e){return new Promise((t,a)=>{const r=document.getElementById("video"),s=document.createElement("canvas"),i=s.getContext("2d");let o;s.width=r.videoWidth,s.height=r.videoHeight,this.isBackCamera||(i.translate(r.videoWidth,0),i.scale(-1,1)),i.drawImage(r,0,0,r.videoWidth,r.videoHeight),o=null!=e.quality?s.toDataURL("image/jpeg",e.quality/100).replace("data:image/jpeg;base64,",""):s.toDataURL("image/png").replace("data:image/png;base64,",""),t({value:o})})}async captureSample(e){return this.capture(e)}async getSupportedFlashModes(){throw new Error("getSupportedFlashModes not supported under the web platform")}async setFlashMode(e){throw new Error("setFlashMode not supported under the web platform")}async flip(){throw new Error("flip not supported under the web platform")}async setOpacity(e){const t=document.getElementById("video");t&&e.opacity&&t.style.setProperty("opacity",e.opacity.toString())}}const i=new s;(0,r.fK)(i)}}]);